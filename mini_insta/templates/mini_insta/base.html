<!-- File: mini_insta/templates/mini_insta/base.html-->
<!-- Author: Louise Lee, llouise@bu.edu, 09/24/2025 -->
<!-- Description: Reusable, consistent structure with a navigation bar and a content block -->

{% load static %}
<html>
  <!-- Title and styling to apply -->
  <head>
    <title>MiniInsta</title>
    <link rel="stylesheet" href="{% static 'styles-insta.css' %}">
  </head>

  <body>
    <!-- Add URL for auth -->
    <nav>
      {% if request.user.is_authenticated %}
        <span>Welcome <strong>{{ request.user.username }}</strong></span>
        <a href="{% url 'show_all_profiles' %}">| Profiles |</a>
        {% if request.user.profiles.first %}
          <a href="{% url 'show_profile' request.user.profiles.first.pk %}">My Profile |</a>
        {% endif %}
        <form method="post" action="{% url 'logout' %}" style="display:inline;">
          {% csrf_token %}
          <button type="submit">Log out</button>
        </form>
      {% else %}
        <a href="{% url 'show_all_profiles' %}">| Profiles |</a>
        <a href="{% url 'create_profile' %}">Create Profile |</a>
        <a href="{% url 'login' %}?next={% url 'show_all_profiles' %}">Log in |</a>
      {% endif %}
    </nav>

    <hr>

    <!-- Display messages (for follow/unfollow/like feedback) -->
    {% if messages %}
      <div class="messages">
        {% for message in messages %}
          <div class="message {{ message.tags }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
    
    <!-- Content of other html -->
    {% block content %}
    {% endblock %}

    <!-- Footer with show_all_profile again and profile image if on show_profile-->
    <div class="footer">
      <a href="{% url 'show_all_profiles' %}"> | 👥 All Profiles | </a>

      {% if request.user.is_authenticated %}
        <a href="{% url 'show_feed' %}">🏠 Feed |</a>
        <a href="{% url 'search' %}">🔎 Search |</a>
        
        {% if request.user.profiles.first %}
          <a href="{% url 'show_profile' request.user.profiles.first.pk %}">
            <img class="footer-pfp" src="{{ request.user.profiles.first.profile_image_url }}" alt="Profile image">
          </a>
          
          <!-- Show "Add Post" only when on your own profile -->
          {% if profile and profile.user == request.user %}
            <a href="{% url 'create_post' %}" class="footer-add-post"> | ➕ Add Post |</a>
          {% endif %}
        {% endif %}
      {% endif %}
    </div>
  </body>
</html>